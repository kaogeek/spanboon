<!--
    @license Spanboon Platform v0.1
    (c) 2020-2021 KaoGeek. http://kaogeek.dev
    License: MIT. https://opensource.org/licenses/MIT
    Author:  p-nattawadee <nattawdee.l@absolute.co.th>, Chanachai-Pansailom <chanachai.p@absolute.co.th>, Americaso <treerayuth.o@absolute.co.th>
-->

<div class="box-post" (window:resize)="onResize()" [ngClass]="class">
    <form #boxPost="ngForm" class="box" *ngIf="!isShowTablet">
        <div *ngIf="isRepost" class="box-story" #headerTop>
            <div class="dropdown-page" *ngIf="isListPage && isHeaderPage && !isEdit && !isFulfill && !isMobilePost;">
                <mat-form-field appearance="none">
                    <div class="selected-dropdown">
                        <ng-container
                            *ngIf="accessPageImage && accessPageImage.imageURL && accessPageImage.imageURL !== '' && accessPageImage.imageURL !== undefined && accessPageImage.imageURL !== null; else elseAccessPage">
                            <img class="img" src="{{accessPageImage.imageURL}}" alt="">
                        </ng-container>
                        <ng-template #elseAccessPage>
                            <div class="donator">
                                <span>{{accessPageImage && ( accessPageImage.displayName || accessPageImage.name |
                                    slice: 0:1 ) }}</span>
                            </div>
                        </ng-template>
                        <mat-select name="pageName" [(ngModel)]="selectedAccessPage">
                            <ng-container *ngFor="let data of accessPage; let index = index">
                                <mat-option *ngIf="index === 0" [value]="selectedAccessPage"
                                    (click)="selectAccessPage(data.user , 'USER')">
                                    <div class="wrapper-img-access">
                                        <div class="img-access">
                                            <ng-container
                                                *ngIf="data.user.imageURL !== '' && data.user.imageURL !== undefined && data.user.imageURL !== null; else elseImageProfile">
                                                <img class="icon-image" src="{{data.user.imageURL}}" alt="">
                                            </ng-container>
                                            <ng-template #elseImageProfile>
                                                <img class="icon-image" src="../../../assets/img/profile1.svg" alt="">
                                            </ng-template>
                                        </div>
                                        <div class="wrapper-body-action">
                                            <div>{{data.user.displayName}}</div>
                                        </div>
                                    </div>
                                </mat-option>
                                <mat-option [value]="data.page.pageUsername || data.page.name "
                                    (click)="selectAccessPage(data.page, 'PAGE')">
                                    <div class="wrapper-img-access">
                                        <div class="img-access">
                                            <ng-container
                                                *ngIf="data.page.imageURL !== '' && data.page.imageURL !== undefined && data.page.imageURL !== null; else elseImageProfile">
                                                <img class="icon-image" src="{{data.page.imageURL}}" alt="">
                                            </ng-container>
                                            <ng-template #elseImageProfile>
                                                <img class="icon-image" src="../../../assets/img/profile1.svg" alt="">
                                            </ng-template>
                                        </div>
                                        <div class="wrapper-body-action">
                                            <div>{{data.page.pageUsername || data.page.name }}</div>
                                        </div>
                                    </div>
                                </mat-option>
                            </ng-container>

                        </mat-select>
                    </div>
                </mat-form-field>
            </div>
            <div *ngIf="isMobilePost" class="mobile-post dropdown-page" (click)="onCloseDialog()">
                ยกเลิก
            </div>

            <div *ngIf="isMobilePost;" class="dropdown-page"
                style="border-left: 0.7px solid #e5e5e5;width: calc(75% - 10pt - 0.7px);">
                <mat-form-field appearance="none">
                    <div class="selected-dropdown">
                        <ng-container
                            *ngIf="accessPageImage && accessPageImage.imageURL && accessPageImage.imageURL !== '' && accessPageImage.imageURL !== undefined && accessPageImage.imageURL !== null; else elseAccessPage">
                            <img class="img" src="{{accessPageImage.imageURL}}" alt="">
                        </ng-container>
                        <ng-template #elseAccessPage>
                            <div class="donator">
                                <span>{{accessPageImage && ( accessPageImage.displayName || accessPageImage.name |
                                    slice: 0:1 ) }}</span>
                            </div>
                        </ng-template>
                        <mat-select name="pageName" [(ngModel)]="selectedAccessPage">
                            <ng-container *ngFor="let data of accessPage; let index = index">
                                <mat-option *ngIf="index === 0" [value]="selectedAccessPage"
                                    (click)="selectAccessPage(data.user , 'USER')">
                                    <div class="wrapper-img-access">
                                        <div class="img-access">
                                            <ng-container
                                                *ngIf="data.user.imageURL !== '' && data.user.imageURL !== undefined && data.user.imageURL !== null; else elseImageProfile">
                                                <img class="icon-image" src="{{data.user.imageURL}}" alt="">
                                            </ng-container>
                                            <ng-template #elseImageProfile>
                                                <img class="icon-image" src="../../../assets/img/profile1.svg" alt="">
                                            </ng-template>
                                        </div>
                                        <div class="wrapper-body-action">
                                            <div>{{data.user.displayName}}</div>
                                        </div>
                                    </div>
                                </mat-option>
                                <mat-option [value]="data.page.pageUsername || data.page.name "
                                    (click)="selectAccessPage(data.page, 'PAGE')">
                                    <div class="wrapper-img-access">
                                        <div class="img-access">
                                            <ng-container
                                                *ngIf="data.page.imageURL !== '' && data.page.imageURL !== undefined && data.page.imageURL !== null; else elseImageProfile">
                                                <img class="icon-image" src="{{data.page.imageURL}}" alt="">
                                            </ng-container>
                                            <ng-template #elseImageProfile>
                                                <img class="icon-image" src="../../../assets/img/profile1.svg" alt="">
                                            </ng-template>
                                        </div>
                                        <div class="wrapper-body-action">
                                            <div>{{data.page.pageUsername || data.page.name }}</div>
                                        </div>
                                    </div>
                                </mat-option>
                            </ng-container>

                        </mat-select>
                    </div>
                </mat-form-field>
            </div>
            <div class="box-toggle">สร้างสตอรี่ :
                <mat-slide-toggle [ngModelOptions]="{standalone: true}" [(ngModel)]="isStory"
                    (change)="onChangeSlide($event)"></mat-slide-toggle>
                <!-- <mat-slide-toggle [ngModelOptions]="{standalone: true}" [(ngModel)]="isChecked" (change)="onToggle($event)"></mat-slide-toggle> -->
            </div>
        </div>
        <ng-container *ngIf="modeShowImage">
            <div class="box-image" *ngIf="imagesTimeline && imagesTimeline.length > 0">
                <ng-container *ngFor="let item of imagesTimeline; let index = index">
                    <ng-container *ngIf="!isLoading; else elseLoadImage">
                        <div class="image-top"
                            *ngIf="(item.image !== undefined || item.galleryBase64 ) && index === 0 ">
                            <img class="list-image" src="{{item.image || item.galleryBase64}}"
                                (click)="onShowDragandDrop()">
                        </div>
                    </ng-container>
                    <ng-template #elseLoadImage>
                        <div class="wrapper-loader image-top" *ngIf="index === 0 ">
                            <div style="height: 100%;" class="loading"></div>
                        </div>
                    </ng-template>
                </ng-container>
                <div class="box-sub-image">
                    <ng-container *ngFor="let image of imagesTimeline; let index = index">
                        <ng-container *ngIf="!isLoading; else elseLoadImageMore">
                            <img *ngIf="index > 0 && index <= 2" class="sub-list-image"
                                src="{{image.image || image.galleryBase64}}" (click)="onShowDragandDrop()">
                            <ng-container *ngIf="index === 3">
                                <ng-container *ngIf="imagesTimeline.length > 4; else elseImageMore">
                                    <div class="list-more">
                                        <img class="sub-list-image" style="width: 100%;"
                                            src="{{image.image || image.galleryBase64}}" (click)="onShowDragandDrop()">
                                        <span class="image-more" (click)="onShowDragandDrop()"> +
                                            {{imagesTimeline.length-4}}
                                        </span>
                                    </div>
                                </ng-container>
                                <ng-template #elseImageMore>
                                    <img class="sub-list-image" src="{{image.image || image.galleryBase64}}"
                                        (click)="onShowDragandDrop()">
                                </ng-template>
                            </ng-container>
                        </ng-container>
                        <ng-template #elseLoadImageMore>
                            <div class="wrapper-loader sub-list-image" *ngIf="index > 0 && index <= 3">
                                <div style="height: 100%;" class="loading"></div>
                            </div>
                        </ng-template>
                    </ng-container>
                </div>
            </div>
        </ng-container>
        <!-- <input [ngStyle]="isRepost? {'display': 'block'} : {'display': 'none'}" type="text" id="topic"
            class="header-story" [class.msg-error-topic]="isMsgNull" placeholder="หัวข้อ" name="topic" #topic
            [(ngModel)]="dataStroy.topic" (keyup)="onKeyupTopic($event)"> -->
        <div matInput contentEditable="true" [ngStyle]="isRepost? {'display': 'block'} : {'display': 'none'}"
            id="{{prefix && prefix.header !== '' ? prefix.header : '' }}topic" #topic class="header-story"
            [class.msg-error-shake]="isMsgNull" placeholder="หัวข้อ" (keyup)="onKeyupTopic($event)" maxlength="80">
        </div>
        <div *ngIf="isRepost" [class.msg-error-shake]="isMsgError" #storyPost
            id="{{prefix &&  prefix.detail? prefix.detail : ''}}editableStoryPost" class="textarea-editor"
            contentEditable="true" attr.placeholder="เรื่องราวของ {{dataPage}}" (keyup)="onKeyup($event)"
            (click)="onKeyup($event)">
        </div>

        <div *ngIf="!isRepost" [class.msg-error-shake]="isMsgError" #storyPost
            id="{{prefix &&  prefix.detail? prefix.detail : ''}}editableStoryPost" class="textarea-editor"
            contentEditable="true" attr.placeholder="ความเห็นของคุณต่อเรื่องราวนี้ {{repostPage}} {{dataPage}}"
            (keyup)="onKeyup($event)" (click)="onKeyup($event)">
        </div>

        <div class="wrapper-selector-tag" *ngIf="selectValueTag && selectValueTag.length > 0 ">
            <div class="keyword-tag" *ngFor="let data of selectValueTag; let index =index">
                <a>#{{data.tag}}</a>
                <i class="material-icons" (click)="onDeleteTagEmergency(index,data.tag)">
                    clear
                </i>
                <span class="space-icon"></span>
            </div>
        </div>
        <needs-card #needsCard style="padding-left: 10pt; padding-right: 10pt; display: block;" [isClose]="true"
            [itemNeeds]="arrListItem" (close)="removeNeeds($event)" [isFulfill]="content && content.isFulfill" [isButtonFulfill]="isButtonFulfill"></needs-card>
        <div class="wrapper-event-tag" #tagEvent [class.active]="isMobilePost && isMobileText">
            <div class="wrapper-right">
                <div *ngIf="isRepost && isMobilePost  && isMobileText" class="text-limit"
                    [class.validate]="getTextLength() > 280" [class.active]="isMobilePost  && isMobileText">
                    {{getTextLength() ? getTextLength() : 0 }}/280
                </div>
            </div>

            <div *ngIf="isRepost" class="wrapper-left">
                <div class="search-tag-emergency" *ngIf="!isFulfill">
                    <div *ngIf="isRepost" class="event-tag" [matMenuTriggerFor]="menuEvent"
                        (menuClosed)="focusOutEmergency()"
                        [class.active-tag1]="isShowEmergency || isEmptyObject(dataAutoComp)" (click)="eventClick()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="23" height="21" viewBox="0 0 23 21">
                            <g id="Group_1312" data-name="Group 1312" transform="translate(-672.701 -415.463)">
                                <path id="Subtraction_2" data-name="Subtraction 2"
                                    d="M-6438.83,1006.048h-12.47V999.7a6.241,6.241,0,0,1,6.235-6.233,6.241,6.241,0,0,1,6.235,6.233v6.351Zm-5.186-11.363a5.776,5.776,0,0,0-3.925,1.269,5.394,5.394,0,0,0-1.9,4.091.55.55,0,0,0,.583.563.55.55,0,0,0,.583-.563,4.24,4.24,0,0,1,1.561-3.267,4.628,4.628,0,0,1,3.1-.928.55.55,0,0,0,.563-.583A.55.55,0,0,0-6444.015,994.686Z"
                                    transform="translate(7129.611 -573.082)" fill="#747474" stroke="rgba(0,0,0,0)"
                                    stroke-miterlimit="10" stroke-width="1" />
                                <path id="Rectangle_572" data-name="Rectangle 572"
                                    d="M2,0H17a2,2,0,0,1,2,2V2a0,0,0,0,1,0,0H0A0,0,0,0,1,0,2V2A2,2,0,0,1,2,0Z"
                                    transform="translate(674.701 434.463)" fill="#747474" />
                                <rect id="Rectangle_573" data-name="Rectangle 573" width="2" height="3" rx="1"
                                    transform="translate(683.701 415.463)" fill="#747474" />
                                <rect id="Rectangle_574" data-name="Rectangle 574" width="1.398" height="3.962"
                                    rx="0.699" transform="translate(678.115 416.918) rotate(-30)" fill="#747474" />
                                <rect id="Rectangle_575" data-name="Rectangle 575" width="1.398" height="3.962"
                                    rx="0.699" transform="matrix(0.523, -0.852, 0.852, 0.523, 674.045, 421.339)"
                                    fill="#747474" />
                                <rect id="Rectangle_576" data-name="Rectangle 576" width="1.398" height="3.962"
                                    rx="0.699" transform="matrix(0.506, 0.862, -0.862, 0.506, 694.212, 420.343)"
                                    fill="#747474" />
                                <rect id="Rectangle_577" data-name="Rectangle 577" width="1.398" height="3.962"
                                    rx="0.699" transform="translate(689.761 416.304) rotate(31.145)" fill="#747474" />
                                <rect id="Rectangle_578" data-name="Rectangle 578" width="1" height="3" rx="0.5"
                                    transform="translate(672.701 427.463) rotate(-90)" fill="#747474" />
                                <rect id="Rectangle_579" data-name="Rectangle 579" width="1" height="3" rx="0.5"
                                    transform="translate(692.701 427.463) rotate(-90)" fill="#747474" />
                            </g>
                        </svg>
                        <ng-container *ngIf="isEmptyObject(dataAutoComp); else elseObjective">
                            {{'#'+dataAutoComp.hashtag}}
                        </ng-container>
                        <ng-template #elseObjective>
                            เหตุการณ์ด่วน
                        </ng-template>
                    </div>
                    <mat-menu #menuEvent="matMenu" (click)="$event.stopPropagation()"
                        (keydown)="$event.stopPropagation()">
                        <div class="au-comp">
                            <div class="header" (click)="$event.stopPropagation()" (keydown)="$event.stopPropagation()">
                                <div class="div-search">
                                    <span class="material-icons icons-search">
                                        search
                                    </span>
                                    <input type="text" name="autocompleteEmergency" matInput id="autocompleteEmergency"
                                        #autocompleteEmergency placeholder="ค้นหา" #autocompleteEmergency
                                        (keyup)="keyUpSearchEmergencyEvent(autocompleteEmergency.value, true)">
                                </div>
                            </div>
                            <div class="panel-checkbox">
                                <mat-option class="mat-uncheck" (click)="removeEmergency()">
                                    <span class="btn-cancel">
                                        ยกเลิกแท็กที่เลือก
                                    </span>
                                </mat-option>
                                <mat-option class="mat-option-progress" *ngIf="isLoading">
                                    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                </mat-option>
                                <mat-option class="list" *ngFor="let item of resEmergency" [value]="item.hashTag"
                                    (click)="selectEvent(item)">
                                    <div class="list-hashtag">
                                        {{'#'+item.hashTag}}
                                        <div class="tag-count">
                                            <span>
                                                {{item.view ? item.view : 0 | shortNumber }} ครั้ง
                                            </span>
                                        </div>
                                    </div>
                                </mat-option>
                            </div>
                        </div>
                    </mat-menu>
                </div>

                <div class="search-objective" *ngIf="modeShowDoing || ( accessPageImage && accessPageImage.name)">
                    <div *ngIf="isRepost" class="objective-doing" [matMenuTriggerFor]="menuEventObjective"
                        (menuClosed)="focusOutObjective()" [class.active-tag]="isShowObjective || dataObjective.hashTag"
                        (click)="clickObjectiveDoing();">
                        <svg class="img-objective" xmlns="http://www.w3.org/2000/svg" width="22.899" height="22.899"
                            viewBox="0 0 22.899 22.899">
                            <g id="mission" transform="translate(0)">
                                <path id="Path_3205" data-name="Path 3205"
                                    d="M4.864,322.8a1.782,1.782,0,0,1,.267-1.475l3.26-4.646L6.552,314.13a.447.447,0,0,0-.726,0L.085,322.093a.447.447,0,0,0,.363.709Z"
                                    transform="translate(0 -299.903)" fill="#747474" />
                                <path id="Path_3206" data-name="Path 3206"
                                    d="M311.071,9.5V7.156h5.59a.671.671,0,0,0,.57-1.025L316.06,4.249l1.171-1.882a.671.671,0,0,0-.57-1.025h-5.59V.671a.671.671,0,1,0-1.342,0V9.5A.865.865,0,0,1,311.071,9.5Z"
                                    transform="translate(-295.877)" fill="#747474" />
                                <path id="Path_3207" data-name="Path 3207"
                                    d="M149.512,349.174l-1.6,1.492a.671.671,0,0,1-.915,0l-1.162-1.082-1.161,1.082a.671.671,0,0,1-.915,0l-1.6-1.492-4.616,6.578a.447.447,0,0,0,.366.7h15.855a.447.447,0,0,0,.366-.7Z"
                                    transform="translate(-131.312 -333.558)" fill="#747474" />
                                <path id="Path_3208" data-name="Path 3208"
                                    d="M260.934,244.4l1.161-1.082a.671.671,0,0,1,.915,0l1.162,1.082,1.292-1.177-2.545-3.626a.447.447,0,0,0-.732,0l-2.545,3.626Z"
                                    transform="translate(-248.03 -228.703)" fill="#747474" />
                            </g>
                        </svg>

                        <ng-container *ngIf="isEmptyObject(dataObjective); else elseDataIcon">
                            {{'#'+dataObjective.hashTag}}
                        </ng-container>
                        <ng-template #elseDataIcon>
                            สิ่งที่กำลังทำ
                        </ng-template>
                    </div>
                    <mat-menu #menuEventObjective="matMenu" (click)="$event.stopPropagation()"
                        (keydown)="$event.stopPropagation()">
                        <ng-container *ngIf="isUpload; else elseUpload">
                            <div class="upload-image-doing" (click)="$event.stopPropagation()">
                                <div class="create-doing">
                                    <div class="wrapper-back">
                                        <svg class="img-back" (click)="$event.stopPropagation()" id="back"
                                            xmlns="http://www.w3.org/2000/svg" width="31" height="31"
                                            viewBox="0 0 31 31" (click)="onBack()">
                                            <g id="Group_1304" data-name="Group 1304">
                                                <path id="Path_3213" data-name="Path 3213"
                                                    d="M15.5,0A15.5,15.5,0,1,0,31,15.5,15.517,15.517,0,0,0,15.5,0ZM19,21.045a1.291,1.291,0,1,1-1.826,1.826l-6.458-6.458a1.29,1.29,0,0,1,0-1.826L17.17,8.128A1.291,1.291,0,1,1,19,9.955L13.451,15.5Z"
                                                    fill="#bfbfbf" />
                                            </g>
                                        </svg>
                                        <div class="btn-create-doing">
                                            สร้างกำลังทำอยู่
                                        </div>
                                    </div>
                                    <div class="wrappper-body-upload" (click)="$event.stopPropagation()">
                                        <div class="wrapper-doing">
                                            <mat-form-field class="objective-category" appearance="none">
                                                <mat-label style="margin-bottom: 2pt;">หมวดหมู่</mat-label>
                                                <mat-select #objectCategory [class.msg-error]="isMsgError"
                                                    [(ngModel)]="selectedValue" name="objectCategory" required>
                                                    <mat-option matInput disabled value="เลือกหมวดหมู่">เลือกหมวดหมู่
                                                    </mat-option>
                                                    <mat-option *ngFor="let item of resPageCategory"
                                                        [value]="item.name">
                                                        {{item.name}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                            <div class="hash">
                                                <span class="wrapper-hashTag">#</span>
                                                <input type="text" class="input-hashTag" id="objective-doing-name"
                                                    name="objective-doing-name" #objectiveDoingName
                                                    placeholder="แฮชแท๊ค" required matInput>
                                            </div>
                                        </div>
                                        <div class="wrapper-doing">
                                            <input type="text" class="input-doing" id="objective-doing"
                                                name="objective-doing" #objectiveDoing placeholder="สิ่งที่คุณกำลังทำ"
                                                required matInput>
                                        </div>
                                        <div class="wrapper-upload">
                                            <ng-container
                                                *ngIf="imageIcon && imageIcon !== undefined; else elseShowImage">
                                                <div class="div-image">
                                                    <img class="image-user"
                                                        src="{{imageIcon.image !== undefined ? imageIcon.image : '../../../../assets/img/image.svg'}}"
                                                        alt="">
                                                </div>
                                            </ng-container>
                                            <ng-template #elseShowImage>
                                                <div class="div-image">
                                                    <img class="image-user" src="../../../../assets/img/image.svg"
                                                        alt="">
                                                </div>
                                            </ng-template>

                                            <div class="wrapper-field-upload">
                                                <div class="top">
                                                    อัพโหลดรูปโปรไฟล์
                                                </div>
                                                <div class="btn-upload">
                                                    <label for="file-upload" class="button-social"
                                                        (click)="showDialogImage(); $event.stopPropagation()">อัพโหลดรูปภาพ
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="wrapper-footer-doing">
                                        <div class="btn-submit">
                                            <spanboon-button (click)="canCelImageObject()" [bgColor]="'#f3f3f3'"
                                                [color]="'#212721'" [text]="'ยกเลิก'">
                                            </spanboon-button>
                                        </div>
                                        <div class="btn-submit">
                                            <spanboon-button (click)="createImageObjective()" [height]="'28pt'"
                                                [width]="'79pt'" [bgColor]="'#FD545A'" [text]="'สร้าง'">
                                            </spanboon-button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                        <ng-template #elseUpload>
                            <div class="wrapper-body-objective">
                                <div class="search-header-objective">
                                    <svg class="img-search" xmlns="http://www.w3.org/2000/svg" width="20.276"
                                        height="20.682" viewBox="0 0 20.276 20.682">
                                        <g id="surface1" transform="translate(-27)">
                                            <path id="Path_104" data-name="Path 104"
                                                d="M14.235,12.272a7.776,7.776,0,1,0-2.392,2.2l5.734,5.7a1.628,1.628,0,0,0,2.36-2.242c-.02-.021-.039-.04-.059-.059ZM7.883,12.8A5.016,5.016,0,1,1,12.9,7.779,5.017,5.017,0,0,1,7.883,12.8Zm0,0"
                                                transform="translate(26.891 0)" fill="#474747" />
                                        </g>
                                    </svg>
                                    <mat-form-field class="form-search-field" appearance="none">
                                        <input matInput placeholder="ค้นหา" #searchInputObjective
                                            id="searchInputObjective"
                                            (keyup)="keyUpSearchObjective(searchInputObjective.value)">
                                    </mat-form-field>
                                </div>
                                <div class="wrapper-add-doing">
                                    <div class="wrapper-add-image">
                                        <div class="page-doing">
                                            สิ่งที่ {{dataPage ? '"'+dataPage+'"' : ''}}
                                            กำลังทำอยู่
                                        </div>
                                        <div class="image-upload" (click)="UploadImage(); $event.stopPropagation()">
                                            <svg class="icon-add" xmlns="http://www.w3.org/2000/svg" width="20.948"
                                                height="20.948" viewBox="0 0 20.948 20.948">
                                                <path id="plus_4_" data-name="plus (4)"
                                                    d="M17.88,3.068A10.474,10.474,0,0,0,3.067,17.88,10.474,10.474,0,0,0,17.88,3.068ZM10.473,19.311a8.837,8.837,0,1,1,8.837-8.837,8.847,8.847,0,0,1-8.837,8.837Zm.818-9.656h3.682v1.637H11.292v3.682H9.655V11.291H5.973V9.655H9.655V5.973h1.637Zm0,0"
                                                    transform="translate(0)" fill="#212721" />
                                            </svg>
                                            เพิ่มใหม่
                                            <div class="lable-add"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="wrapper-choose-tag">
                                    <div class="wrapper-body-doing">
                                        <ng-container
                                            *ngIf="resObjective && resObjective.length > 0; else elseHasObjective">
                                            <div class="wrapper-doing" id="wrapper-doing"
                                                [class.active-click-doing]="selectedObjectiveId === item.id"
                                                *ngFor="let item of resObjective ; let i = index"
                                                (click)="clickCardObjective(i,item)">

                                                <ng-container
                                                    *ngIf="isLoading || item.isLoadImageIcon ; else elseIsicon">
                                                    <span class="loading-image">
                                                        <div class="linear-background">
                                                        </div>
                                                    </span>
                                                </ng-container>
                                                <ng-template #elseIsicon>
                                                    <ng-container
                                                        *ngIf="item.iconURL === '' || item.iconURL === null || item.iconURL === undefined; else elseIsBase64">
                                                        <div class="image-tag image-waste">
                                                            <img src="../../../../assets/img/photo.png"
                                                                style="width: 40%; height: auto;">
                                                        </div>
                                                    </ng-container>
                                                    <ng-template #elseIsBase64>
                                                        <ng-container
                                                            *ngIf="item.iconBase64 !== '' && item.iconBase64 !== undefined && item.iconBase64 !== null ; else elsecheckBase">
                                                            <img class="image-tag" src="{{item.iconBase64}}" alt="">
                                                        </ng-container>
                                                        <ng-template #elsecheckBase>
                                                            <div class="image-tag image-waste">
                                                                <img src="../../../../assets/img/photo.png"
                                                                    style="width: 40%; height: auto;">
                                                            </div>
                                                        </ng-template>
                                                    </ng-template>
                                                </ng-template>

                                                <span class="name-objective">{{'#'+item.hashTag}}</span>
                                                <div class="div-objective">
                                                    <span>(</span>
                                                    <span class="name-objective bo_2">{{item.title}}</span>
                                                    <span>)</span>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-template #elseHasObjective>
                                            <div class="wrapper-not-objective">
                                                ไม่ค้นพบข้อมูล
                                            </div>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </mat-menu>
                </div>
            </div>
            <div class="wrapper-middle" #middle>
                <div class="wrapper-edit-story" *ngIf="(isEmptyObject(dataStroy) || isDataStroy) && isStory">
                    <div class="edit-story" (click)="showDialogCreateStory(true)">
                        แก้ไขสตอรี่
                    </div>
                </div>
                <ng-container *ngIf="arrListItem && arrListItem.length > 0 && isTypeNeed; else elseNeeds">
                    <div class="wrapper-edit-story" (click)="showDialogDoing()">
                        <span class="label-needs"> กำลังมองหา {{getObjectLength(arrListItem)}} รายการ</span>
                    </div>
                </ng-container>
                <ng-template #elseNeeds>
                    <div *ngIf="typeStroy === 'NEEDS'" class="wrapper-edit-story" (click)="showDialogDoing()">
                        <span class="label-needs" id="needs" [class.msg-error-shake]="isMsgNeeds">กำลังมองหา 0
                            รายการ</span>
                    </div>
                </ng-template>
            </div>
            <div class="wrapper-right">
                <ng-container *ngIf="isTablet; else elseTemplateisTablet">
                    <!-- version tablet -->
                    <div class="text-limit" [class.validate]="getTextLength() > 280">
                        {{getTextLength() ? getTextLength() : 0 }}/280
                    </div>
                </ng-container>
                <ng-template #elseTemplateisTablet>
                    <div *ngIf="isRepost && !isMobilePost && !isMobileText " class="text-limit"
                        [class.validate]="getTextLength() > 280">
                        {{getTextLength() ? getTextLength() : 0 }}/280
                    </div>
                </ng-template>
            </div>
        </div>

        <div *ngIf="!isRepost" style="padding: 20px;">
            <repost-data [isRepost]="true" [itemPost]="rePote"></repost-data>
        </div>

        <!-- <div class="fulfill-items-wrapper" *ngIf="isFulfill">
            <div class="fulfill-items-header">
                <div class="header-left">
                    <span>รายการเติมเต็ม</span>
                </div>
                <div class="header-right">
                    <span>{{content.fulfillRequest.length}} รายการ</span>
                </div>
            </div>
            <div class="fulfill-items" *ngFor="let item of content.fulfillRequest">
                <card-fulfill-item [itemName]="item.name" [itemUnit]="item.unit" [itemQuantity]="item.quantity"
                    [imageURL]='item.imageURL'>
                </card-fulfill-item>
            </div>
        </div> -->

        <div class="wrapper-tool-post" #toolBar (window:resize)="onResize()">
            <div class="left" [ngStyle]="{'border-right': isFulfill ? 'unset':'0.7px solid #e5e5e5'}">
                <mat-form-field appearance="none" *ngIf="!isFulfill">
                    <mat-select *ngIf="isRepost;" #matSelect [(ngModel)]="selected"
                        [ngModelOptions]="{standalone: true}">
                        <ng-container *ngIf="modeDoIng ; else elseDoIng">
                            <mat-option *ngFor="let data of chooseStorys" [value]="data.value"
                                (click)="selectType(data.value)">
                                <div class="wrapper-body-action">
                                    <div class="{{data.class}}"></div>
                                    {{data.viewValue}}
                                </div>
                            </mat-option>
                        </ng-container>
                        <ng-template #elseDoIng>
                            <mat-option *ngFor="let data of chooseStory" [value]="data.value"
                                (click)="selectType(data.value)">
                                <div class="wrapper-body-action">
                                    <div class="{{data.class}}"></div>
                                    {{data.viewValue}}
                                </div>
                            </mat-option>
                        </ng-template>
                    </mat-select>
                    <mat-select *ngIf="!isRepost;" #matSelect [(value)]="selectedPage">
                        <mat-option [value]="'แชร์เข้าไทมไลน์ของฉัน'">
                            <div class="wrapper-body-action">
                                {{"แชร์เข้าไทมไลน์ของฉัน"}}
                            </div>
                        </mat-option>
                        <mat-option *ngFor="let data of pages" [value]="data.id">
                            <div class="wrapper-body-action">
                                {{data.name}}
                            </div>
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="center" style="justify-content: flex-end;">
                <!-- <img class="btn-action" src="../../../assets/img/vision.png" alt=""> -->
                <div class="wrapper-action">
                    <div class="tag-drop" #menuTrigger="matMenuTrigger" [matMenuTriggerFor]="menuTag"
                        (menuClosed)="focusOutTag()" (click)="clickListTag()">
                        <svg class="img-action"
                            [class.active-click]="isShowCheckboxTag || checkActiveList() || isEmptyObject(dataAutoComp) || selectValueTag.length > 0"
                            id="tag_1_" data-name="tag (1)" xmlns="http://www.w3.org/2000/svg" width="20.16"
                            height="18.014" viewBox="0 0 20.16 18.014">
                            <g id="Group_90" data-name="Group 90" transform="translate(0 0)">
                                <g id="Group_89" data-name="Group 89" transform="translate(0 0)">
                                    <path id="Path_146" data-name="Path 146"
                                        d="M15.725,23.224H9.535a1.479,1.479,0,0,0-1.045.433L.433,31.713a1.479,1.479,0,0,0,0,2.091l6.19,6.19a1.478,1.478,0,0,0,2.09,0l8.057-8.056a1.482,1.482,0,0,0,.433-1.047V24.7A1.478,1.478,0,0,0,15.725,23.224ZM13.138,28.4a1.109,1.109,0,1,1,1.109-1.109A1.109,1.109,0,0,1,13.138,28.4Z"
                                        transform="translate(0 -23.224)" fill="#343434" />
                                </g>
                            </g>
                            <g id="Group_92" data-name="Group 92" transform="translate(10.117 1.478)">
                                <g id="Group_91" data-name="Group 91" transform="translate(0 0)">
                                    <path id="Path_147" data-name="Path 147"
                                        d="M227.553,55.224V62.1a1.284,1.284,0,0,1-.377.909L218.988,71.2l.126.126a1.478,1.478,0,0,0,2.09,0l7.393-7.392a1.476,1.476,0,0,0,.434-1.045V56.7A1.478,1.478,0,0,0,227.553,55.224Z"
                                        transform="translate(-218.988 -55.224)" fill="#343434" />
                                </g>
                            </g>
                        </svg>
                    </div>
                    <mat-menu #menuTag="matMenu" class="drop-list" (click)="$event.stopPropagation()"
                        (keydown)="$event.stopPropagation()">
                        <div class="au-comp" *ngIf="isShowCheckboxTag">
                            <div class="header" (click)="$event.stopPropagation()" (keydown)="$event.stopPropagation()">
                                <div class="div-search">
                                    <span class="material-icons icons-search">
                                        search
                                    </span>
                                    <input type="text" matInput name="autocompleteField" id="autocompleteField"
                                        #autocompleteField placeholder="ค้นหา" #autoCompleteTag
                                        (keyup)="keyUpSearchHashTag(autocompleteField.value , false)">
                                </div>
                                <nav mat-tab-nav-bar animationDuration="0ms" (click)="$event.stopPropagation()"
                                    (keydown)="$event.stopPropagation()">
                                    <a mat-tab-link *ngFor="let link of links" [disableRipple]="true"
                                        (click)="keyUpSearchHashTag('',false); activeLink = link.keyword"
                                        [active]="activeLink == link.keyword">
                                        {{link.label}}
                                    </a>
                                </nav>
                            </div>
                            <div class="panel-checkbox">
                                <mat-option class="mat-uncheck" (click)="menuTrigger.closeMenu(); unCheckboxAll()">
                                    <span class="btn-cancel">
                                        ยกเลิกทั้งหมด
                                    </span>
                                </mat-option>
                                <ng-container *ngIf="activeLink === 'tab1'; else elseTab">
                                    <mat-option class="mat-option-progress" *ngIf="isLoading">
                                        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                    </mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option [ngClass]="{'dis': onPost}" class="list"
                                            *ngFor="let item of resHashTag" [value]="item.value">
                                            <div class="list-checkbox" (click)="optionClicked($event, item);">
                                                <mat-checkbox (click)="$event.stopPropagation()" name="{{item.value}}"
                                                    [(ngModel)]="item.selected" value="{{item.id}}"
                                                    [ngModelOptions]="{standalone: true}"
                                                    (change)="checkCheckBoxvalue($event, item)">
                                                    #{{item.value}}
                                                    <div class="tag-count">
                                                        {{item.count ? item.count : 0 | shortNumber }} ครั้ง
                                                    </div>
                                                </mat-checkbox>
                                            </div>
                                        </mat-option>
                                    </ng-container>
                                </ng-container>
                                <ng-template #elseTab>
                                    <mat-option class="mat-option-progress" *ngIf="isLoading">
                                        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
                                    </mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <ng-container *ngFor="let item of listTag">
                                            <mat-option class="list" *ngIf="item.isServer !== false"
                                                [value]="item.name">
                                                <div class="list-checkbox" (click)="optionClicked($event, item);">
                                                    <mat-checkbox (click)="$event.stopPropagation()"
                                                        name="{{item.name}}" [(ngModel)]="item.selected"
                                                        (change)="checkCheckBoxvalue($event, item)">
                                                        #{{item.name}}
                                                        <div class="tag-count">
                                                            <span>
                                                                {{item.count ? item.count : 0 | shortNumber }} ครั้ง
                                                            </span>
                                                        </div>
                                                    </mat-checkbox>
                                                </div>
                                            </mat-option>
                                        </ng-container>

                                    </ng-container>
                                </ng-template>
                            </div>
                        </div>
                    </mat-menu>

                    <div *ngIf="isRepost" class="wrapper-toolbar-action">
                        <ng-container *ngIf="imagesTimeline && imagesTimeline.length > 0 ; else elseDragandDrop">
                            <svg [class.active-click]="isShowImage || imagesTimeline.length > 0" id="photo"
                                xmlns="http://www.w3.org/2000/svg" width="20.094" height="18.42"
                                viewBox="0 0 20.094 18.42" (click)="onShowDragandDrop()">
                                <path id="Path_143" data-name="Path 143"
                                    d="M5.232,157.223a3.135,3.135,0,0,1-2.966-2.136l-.029-.1a3.056,3.056,0,0,1-.145-.908v-5.709l-2.031,6.78a1.9,1.9,0,0,0,1.333,2.307l12.947,3.467a1.921,1.921,0,0,0,.482.062,1.867,1.867,0,0,0,1.809-1.369l.754-2.4Zm0,0"
                                    transform="translate(0 -142.571)" fill="#343434" />
                                <path id="Path_144" data-name="Path 144"
                                    d="M150.995,67.841a1.675,1.675,0,1,0-1.675-1.675A1.676,1.676,0,0,0,150.995,67.841Zm0,0"
                                    transform="translate(-143.46 -61.98)" fill="#343434" />
                                <path id="Path_145" data-name="Path 145"
                                    d="M99.972.492H87.413A2.1,2.1,0,0,0,85.32,2.586V11.8a2.1,2.1,0,0,0,2.093,2.093H99.972a2.1,2.1,0,0,0,2.093-2.093V2.586A2.1,2.1,0,0,0,99.972.492ZM87.413,2.167H99.972a.419.419,0,0,1,.419.419V8.529L97.746,5.443a1.5,1.5,0,0,0-1.123-.515,1.464,1.464,0,0,0-1.119.528L92.4,9.189,91.382,8.178a1.47,1.47,0,0,0-2.076,0l-2.311,2.31v-7.9A.419.419,0,0,1,87.413,2.167Zm0,0"
                                    transform="translate(-81.971 -0.492)" fill="#343434" />
                            </svg>

                        </ng-container>
                        <ng-template #elseDragandDrop>
                            <div class="box-image-upload">
                                <label for="{{prefix_button}}">
                                    <svg [class.active-click]="isShowImage || imagesTimeline.length > 0" id="photo"
                                        xmlns="http://www.w3.org/2000/svg" width="20.094" height="18.42"
                                        viewBox="0 0 20.094 18.42">
                                        <path id="Path_143" data-name="Path 143"
                                            d="M5.232,157.223a3.135,3.135,0,0,1-2.966-2.136l-.029-.1a3.056,3.056,0,0,1-.145-.908v-5.709l-2.031,6.78a1.9,1.9,0,0,0,1.333,2.307l12.947,3.467a1.921,1.921,0,0,0,.482.062,1.867,1.867,0,0,0,1.809-1.369l.754-2.4Zm0,0"
                                            transform="translate(0 -142.571)" fill="#343434" />
                                        <path id="Path_144" data-name="Path 144"
                                            d="M150.995,67.841a1.675,1.675,0,1,0-1.675-1.675A1.676,1.676,0,0,0,150.995,67.841Zm0,0"
                                            transform="translate(-143.46 -61.98)" fill="#343434" />
                                        <path id="Path_145" data-name="Path 145"
                                            d="M99.972.492H87.413A2.1,2.1,0,0,0,85.32,2.586V11.8a2.1,2.1,0,0,0,2.093,2.093H99.972a2.1,2.1,0,0,0,2.093-2.093V2.586A2.1,2.1,0,0,0,99.972.492ZM87.413,2.167H99.972a.419.419,0,0,1,.419.419V8.529L97.746,5.443a1.5,1.5,0,0,0-1.123-.515,1.464,1.464,0,0,0-1.119.528L92.4,9.189,91.382,8.178a1.47,1.47,0,0,0-2.076,0l-2.311,2.31v-7.9A.419.419,0,0,1,87.413,2.167Zm0,0"
                                            transform="translate(-81.971 -0.492)" fill="#343434" />
                                    </svg>
                                </label>
                                <input id="{{prefix_button}}" type="file" (change)="onFileMultiSelectedImage($event)"
                                    accept="image/*" multiple />
                            </div>
                        </ng-template>
                    </div>
                </div>
            </div>
            <div class="right">
                <div class="div-gatdata-post" (click)="onClickGetDataPost()"></div>
                <ng-container *ngIf="isFulfill; else elseIsFulfill">
                    <mat-form-field appearance="none">
                        <mat-select [(value)]="selected1">
                            <mat-option *ngIf="isFulfill" [value]="'โพสต์'" (click)="onClickGetDataPost()">
                                โพสต์
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </ng-container>
                <ng-template #elseIsFulfill>
                    <mat-form-field appearance="none" [class.active]="isMobilePost || isMobileButton">
                        <mat-select [(value)]="selected1">
                            <ng-container *ngIf="isEdit; else elseIsEdit">
                                <mat-option [value]="'แก้ไขโพสต์'" (click)="onClickGetDataPost()">
                                    แก้ไขโพสต์
                                </mat-option>
                            </ng-container>
                            <ng-template #elseIsEdit>
                                <mat-option *ngIf="isRepost" [value]="'โพสต์'" (click)="onClickGetDataPost()">
                                    โพสต์
                                </mat-option>
                                <mat-option *ngIf="!isRepost" [value]="'โพสต์'" (click)="onClickGetDataPost()">
                                    โพสต์
                                </mat-option>
                                <mat-option *ngIf="isRepost" [value]="'บันทึกฉบับร่าง'"
                                    (click)="onClickGetDataPost(true)">
                                    บันทึกฉบับร่าง
                                </mat-option>
                                <mat-option *ngIf="isRepost" [value]="'ตั้งเวลาโพสต์'" (click)="onClickSettingTime()">
                                    ตั้งเวลาโพสต์
                                </mat-option>
                            </ng-template>
                        </mat-select>
                    </mat-form-field>
                </ng-template>
            </div>
        </div>
    </form>

    <div class="section-tablet" *ngIf="isShowTablet">
        <ng-container *ngIf="profile !== '' && profile !== null && profile !== undefined; else elseTemplateProfile">
            <img src="{{profile}}" alt="" class="img-profile">
        </ng-container>
        <ng-template #elseTemplateProfile>
            <img src="../../../../assets/img/profile.svg" class="img-profile">
        </ng-template>
        <div class="to-dialog-post" (click)="dialogPost()">
            เรื่องราวของ {{dataPage}}
        </div>
    </div>
</div>