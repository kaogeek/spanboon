<!--
    @license Spanboon Platform v0.1
    (c) 2020-2021 KaoGeek. http://kaogeek.dev
    License: MIT. https://opensource.org/licenses/MIT
    Author:  p-nattawadee <nattawdee.l@absolute.co.th>, Chanachai-Pansailom <chanachai.p@absolute.co.th>, Americaso <treerayuth.o@absolute.co.th>
-->

<div class="card-contact" (click)="getFulfillmentCase($event)" [ngStyle]="{'background': isActive ? '#f1f1f1':'#fff'}"> 
    <div class="card-color" [ngStyle]="{'background-color': statusColor}"></div>

    <div class="user-contact">
        <ng-container *ngIf="imageURL !== '' && imageURL !== undefined && imageURL !== null ; else elseImage">
            <img class="img" src="{{imageURL}}" alt="">
        </ng-container>
        <ng-template #elseImage>
            <div class="donator"> {{name | slice: 0:1 }} </div>
        </ng-template>

        <div class="card-contact-body">
            <div class="contact-head">
                <div class="head-left" matTooltipShowDelay="{{800}}" matTooltip="{{title}}">
                    {{title}}
                </div>
                <div class="head-right" *ngIf="unreadMessageCount > 0">
                    <span class="count-contact-user" >{{unreadMessageCount}}</span>
                    <!-- <span class="material-icons status" [ngStyle]="{'color': statusRead}">
                        lens
                    </span> -->
                </div>
            </div>
            <div class="contact-hashtag">
                <div class="contact-content"
                    *ngIf="emergencyEvent !== null && emergencyEvent !== undefined && emergencyEvent !== ''">
                    <svg class="icon" height="21" viewBox="0 0 23 21" width="23" xmlns="http://www.w3.org/2000/svg">
                        <g data-name="Group 1312" id="Group_1312" transform="translate(-672.701 -415.463)">
                            <path
                                d="M-6438.83,1006.048h-12.47V999.7a6.241,6.241,0,0,1,6.235-6.233,6.241,6.241,0,0,1,6.235,6.233v6.351Zm-5.186-11.363a5.776,5.776,0,0,0-3.925,1.269,5.394,5.394,0,0,0-1.9,4.091.55.55,0,0,0,.583.563.55.55,0,0,0,.583-.563,4.24,4.24,0,0,1,1.561-3.267,4.628,4.628,0,0,1,3.1-.928.55.55,0,0,0,.563-.583A.55.55,0,0,0-6444.015,994.686Z"
                                data-name="Subtraction 2" fill="#747474" id="Subtraction_2" stroke="rgba(0,0,0,0)"
                                stroke-miterlimit="10" stroke-width="1" transform="translate(7129.611 -573.082)"></path>
                            <path d="M2,0H17a2,2,0,0,1,2,2V2a0,0,0,0,1,0,0H0A0,0,0,0,1,0,2V2A2,2,0,0,1,2,0Z"
                                data-name="Rectangle 572" fill="#747474" id="Rectangle_572"
                                transform="translate(674.701 434.463)"></path>
                            <rect data-name="Rectangle 573" fill="#747474" height="3" id="Rectangle_573" rx="1"
                                transform="translate(683.701 415.463)" width="2"></rect>
                            <rect data-name="Rectangle 574" fill="#747474" height="3.962" id="Rectangle_574" rx="0.699"
                                transform="translate(678.115 416.918) rotate(-30)" width="1.398"></rect>
                            <rect data-name="Rectangle 575" fill="#747474" height="3.962" id="Rectangle_575" rx="0.699"
                                transform="matrix(0.523, -0.852, 0.852, 0.523, 674.045, 421.339)" width="1.398"></rect>
                            <rect data-name="Rectangle 576" fill="#747474" height="3.962" id="Rectangle_576" rx="0.699"
                                transform="matrix(0.506, 0.862, -0.862, 0.506, 694.212, 420.343)" width="1.398"></rect>
                            <rect data-name="Rectangle 577" fill="#747474" height="3.962" id="Rectangle_577" rx="0.699"
                                transform="translate(689.761 416.304) rotate(31.145)" width="1.398"></rect>
                            <rect data-name="Rectangle 578" fill="#747474" height="3" id="Rectangle_578" rx="0.5"
                                transform="translate(672.701 427.463) rotate(-90)" width="1"></rect>
                            <rect data-name="Rectangle 579" fill="#747474" height="3" id="Rectangle_579" rx="0.5"
                                transform="translate(692.701 427.463) rotate(-90)" width="1"></rect>
                        </g>
                    </svg>
                    <span class="contact-event" matTooltipShowDelay="{{800}}"
                        matTooltip="#{{emergencyEvent}}">#{{emergencyEvent}}</span>
                </div>
                <div class="contact-content" *ngIf="objective !== null && objective !== undefined && objective !== ''">
                    <svg class="icon" height="22.899" viewBox="0 0 22.899 22.899" width="22.899"
                        xmlns="http://www.w3.org/2000/svg">
                        <g id="mission" transform="translate(0)">
                            <path
                                d="M4.864,322.8a1.782,1.782,0,0,1,.267-1.475l3.26-4.646L6.552,314.13a.447.447,0,0,0-.726,0L.085,322.093a.447.447,0,0,0,.363.709Z"
                                data-name="Path 3205" fill="#747474" id="Path_3205" transform="translate(0 -299.903)">
                            </path>
                            <path
                                d="M311.071,9.5V7.156h5.59a.671.671,0,0,0,.57-1.025L316.06,4.249l1.171-1.882a.671.671,0,0,0-.57-1.025h-5.59V.671a.671.671,0,1,0-1.342,0V9.5A.865.865,0,0,1,311.071,9.5Z"
                                data-name="Path 3206" fill="#747474" id="Path_3206" transform="translate(-295.877)">
                            </path>
                            <path
                                d="M149.512,349.174l-1.6,1.492a.671.671,0,0,1-.915,0l-1.162-1.082-1.161,1.082a.671.671,0,0,1-.915,0l-1.6-1.492-4.616,6.578a.447.447,0,0,0,.366.7h15.855a.447.447,0,0,0,.366-.7Z"
                                data-name="Path 3207" fill="#747474" id="Path_3207"
                                transform="translate(-131.312 -333.558)"></path>
                            <path
                                d="M260.934,244.4l1.161-1.082a.671.671,0,0,1,.915,0l1.162,1.082,1.292-1.177-2.545-3.626a.447.447,0,0,0-.732,0l-2.545,3.626Z"
                                data-name="Path 3208" fill="#747474" id="Path_3208"
                                transform="translate(-248.03 -228.703)"></path>
                        </g>
                    </svg>
                    <span class="contact-event" matTooltipShowDelay="{{800}}"
                        matTooltip="#{{objective}}">#{{objective}}</span>
                </div>
                <div class="contact-content"
                    [ngStyle]="{'margin': objective === '' || emergencyEvent === '' ? '0px 10pt 0px 8px' :  'unset' }">
                    <span class="contact-event"
                        [ngStyle]="{'margin': objective === '' || emergencyEvent === '' ? '0px 10pt 0px 8px' :  'unset' }">
                        <ng-container *ngIf="(objective !== null && objective !== undefined && objective !== '') || (emergencyEvent !== null && emergencyEvent !== undefined && emergencyEvent !== ''); else elseTemplate">
                            <span class="pointer">·</span>
                            <span class="list-length">  {{fulfillRequestCount}} รายการเติมเต็ม </span>
                        </ng-container>
                        <ng-template #elseTemplate> 
                            <span class="list-length">  {{fulfillRequestCount}} รายการเติมเต็ม </span>
                        </ng-template>
                    </span>
                </div>
            </div>
            <div class="user-contact">
                <span class="user">
                    <ng-container *ngIf="type === 'PAGE'; else elseAsPage">
                        <span *ngIf="!asPage" class="user-name" [ngStyle]="{'color': '#7d8494','padding-right':'5pt'}" matTooltipShowDelay="{{800}}" matTooltip="{{name}}">{{name}}: </span>
                        <span *ngIf="asPage" class="user-name" [ngStyle]="{'padding-right':'5pt'}">คุณ: </span>
                    </ng-container>
                    <ng-template #elseAsPage>
                        <span  *ngIf="asPage" class="user-name" [ngStyle]="{'color': '#7d8494','padding-right':'5pt'}" matTooltipShowDelay="{{800}}" matTooltip="{{name}}">{{name}}: </span>
                        <span *ngIf="!asPage" class="user-name" [ngStyle]="{'color': '#7d8494','padding-right':'5pt'}">คุณ: </span>
                    </ng-template>
                </span>  
                <span class="contact-text" matTooltipShowDelay="{{800}}" [class.active]="!isRead"
                    matTooltip="{{chatMessage}}">{{chatMessage}}</span>
                <span class="pointer"
                    *ngIf="(chatMessage !== null && chatMessage !== undefined && chatMessage !== '') && (chatDate !== null && chatDate !== undefined && chatDate !== '')">·</span>
                <span class="contact-date">{{chatDate}}</span>
            </div>
        </div>
    </div>
</div>