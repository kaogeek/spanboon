<div class="wrapper-statistic-page">
    <div class="wrapper-left">
        <div class="menu-wrapper">
            <p [attr.aria-label]="'แดชบอร์ด'">แดชบอร์ด</p>
            <ng-container *ngFor="let item of menuList">
                <div class="menu-box" role="button" [class.active]="activeMenu === item.status"
                    [routerLink]="!!item.status ? ['', 'dashboard', item.status] : ['','dashboard']">
                    <div class="icon">
                        <img [ngStyle]="{'width': item.status !== activeMenu && (item.status === 'my-vote' || item.status === 'result') ? '24px' : '16px','height': item.status !== activeMenu && (item.status === 'my-vote' || item.status === 'result') ? '24px' : '16px'}"
                            [src]="item.status === activeMenu ? item.icon2 : item.icon">
                    </div>
                    <span>{{item.name}}</span>
                </div>
            </ng-container>
        </div>
    </div>
    <div class="wrapper-right">
        <div class="menu-wrapper">
            <ng-container *ngFor="let item of menuList">
                <div class="menu-box" role="button" [class.active]="activeMenu === item.status"
                    [routerLink]="!!item.status ? ['', 'dashboard', item.status] : ['','dashboard']">
                    <span [class.active]="activeMenu === item.status">{{item.name}}</span>
                </div>
            </ng-container>
        </div>
        <ng-container *ngIf="activeMenu === '' || activeMenu === undefined">
            <div class="wrapper-chart" [ngStyle]="{'display': isLoading ? 'none' : 'grid'}">
                <div class="chart">
                    <span [attr.aria-label]="'ผู้ใช้งานแต่ละจังหวัดบนแพลตฟอร์ม'">ผู้ใช้งานแต่ละจังหวัดบนแพลตฟอร์มในปี
                        {{!!data && !!data.Year ? data.Year : 2024}}</span>
                    <apx-chart [series]="chartPie.series" [chart]="chartPie.chart" [labels]="chartPie.labels"
                        [responsive]="chartPie.responsive" [legend]="chartPie.legend"></apx-chart>
                </div>
                <div class="container-item">
                    <div class="header">
                        <span style="font-weight: bold;" [attr.aria-label]="'MFP'">MFP </span>
                        <span [attr.aria-label]="'Dashboard'">Dashboard</span>
                    </div>
                    <datepicker-year (chooseDate)="chooseDate($event)"></datepicker-year>
                    <div class="wrapper-item">
                        <div class="item">
                            <span [attr.aria-label]="'ยอดสมาชิกพรรค'">ยอดสมาชิกพรรค</span>
                            <p>{{totalMFP | number: '1.0-0':'en-US'}}</p>
                        </div>
                        <div class="item">
                            <span [attr.aria-label]="'ยอดผู้ใช้งาน'">ยอดผู้ใช้งาน</span>
                            <p>{{totalUser | number: '1.0-0':'en-US'}}</p>
                        </div>
                    </div>
                </div>
                <div class="chart" style="grid-column: 1 / span 2;">
                    <span
                        [attr.aria-label]="'การสมัครสมาชิกบนแพลตฟอร์มของแต่ละเดือน'">การสมัครสมาชิกบนแพลตฟอร์มของแต่ละเดือนในปี
                        {{!!data && !!data.Year ? data.Year : 2024}}</span>
                    <apx-chart [series]="chartOptions.series" [chart]="chartOptions.chart" [xaxis]="chartOptions.xaxis"
                        [dataLabels]="chartOptions.dataLabels" [grid]="chartOptions.grid" [stroke]="chartOptions.stroke"
                        [title]="chartOptions.title"></apx-chart>
                </div>
            </div>
        </ng-container>
        <ng-container *ngIf="activeMenu === 'mfp'">
            <div class="wrapper-chart mfp" [ngStyle]="{'display': isLoading ? 'none' : 'grid'}">
                <div class="container-item">
                    <div class="header">
                        <span style="font-weight: bold;" [attr.aria-label]="'MFP'">MFP </span>
                        <span [attr.aria-label]="'Dashboard'">Dashboard</span>
                    </div>
                    <div class="wrapper-item">
                        <div class="item">
                            <span [attr.aria-label]="'ยอดสมาชิกพรรค'">ยอดสมาชิกพรรค</span>
                            <p>{{totalMFP | number: '1.0-0':'en-US'}}</p>
                        </div>
                        <div class="item">
                            <span [attr.aria-label]="'ยอดผู้ใช้งาน'">ยอดผู้ใช้งาน</span>
                            <p>{{totalUser | number: '1.0-0':'en-US'}}</p>
                        </div>
                    </div>
                </div>
                <div class="chart" [ngStyle]="{'grid-row': '2'}">
                    <span
                        [attr.aria-label]="'สมาชิกพรรคก้าวไกลแต่ละจังหวัดบนแพลตฟอร์ม'">สมาชิกพรรคก้าวไกลแต่ละจังหวัดบนแพลตฟอร์มในปี
                        {{!!data && !!data.Year ? data.Year :
                        2024}}</span>
                    <apx-chart [series]="chartPie.series" [chart]="chartPie.chart" [labels]="chartPie.labels"
                        [responsive]="chartPie.responsive" [legend]="chartPie.legend"></apx-chart>
                </div>
                <div class="chart" [ngStyle]="{'grid-row': '2'}">
                    <apx-chart [series]="chartBar.series" [chart]="chartBar.chart" [dataLabels]="chartBar.dataLabels"
                        [stroke]="chartBar.stroke" [colors]="chartBar.colors" [title]="chartBar.title"
                        [subtitle]="chartBar.subtitle" [plotOptions]="chartBar.plotOptions" [yaxis]="chartBar.yaxis"
                        [xaxis]="chartBar.xaxis" [tooltip]="chartBar.tooltip"></apx-chart>
                </div>
            </div>
        </ng-container>
        <ng-container *ngIf="activeMenu === 'leaderboard'">
            <div class="wrapper-leaderboard" [ngStyle]="{'display': isLoading ? 'none' : 'flex'}">
                <div class="container">
                    <div class="header">
                        <span [attr.aria-label]="'เพจโดดเด่น 50 อันดับ'">เพจโดดเด่น 50 อันดับ</span>
                        <span
                            [attr.aria-label]="'จำนวนเพจที่มีผู้ติดตามมากที่สุดจากมากไปน้อย 50 อันดับแรก'">จำนวนเพจที่มีผู้ติดตามมากที่สุดจากมากไปน้อย
                            50 อันดับแรก</span>
                    </div>
                    <div class="wrapper-page" *ngIf="!!listPage"
                        [ngStyle]="{'grid-template-columns': listPage.length <= 24 ? '1fr' : 'repeat(2, 1fr)'}">
                        <ng-container *ngFor="let item of listPage;let index = index">
                            <div class="page"
                                [ngStyle]="{'grid-column': index <= 24 ? '1' : '2', 'grid-row': index > 24 ? getGridRow(index) : ''}">
                                <div class="ranking">
                                    <img *ngIf="index === 0" src="../../../../assets/img/ranking-1.png" alt="อันดับ1">
                                    <img *ngIf="index === 1" src="../../../../assets/img/ranking-2.png" alt="อันดับ2">
                                    <img *ngIf="index === 2" src="../../../../assets/img/ranking-3.png" alt="อันดับ3">
                                    <span *ngIf="index > 2" [attr.aria-label]="'อันดับ ' + index + 1"
                                        class="ordering">{{index + 1}}</span>
                                    <ng-container *ngIf="!!item.imageURL; else elseImage">
                                        <img class="image" [src]="apiBaseURL + item.imageURL + '/image'" alt="">
                                    </ng-container>
                                    <ng-template #elseImage>
                                        <span class="image image-null">{{item.name | slice:0:1}}</span>
                                    </ng-template>
                                    <span class="name">{{item.name}}</span>
                                </div>
                                <div class="count">
                                    <span>{{ item.userFollow.total_follows | number: '1.0-0':'en-US' }}</span>
                                    <svg class="icon-user" id="user_3_" data-name="user (3)"
                                        xmlns="http://www.w3.org/2000/svg" width="30.332" height="36.356"
                                        viewBox="0 0 30.332 36.356">
                                        <path id="Path_136" data-name="Path 136"
                                            d="M95.788,17.513a8.472,8.472,0,0,0,6.191-2.565,8.473,8.473,0,0,0,2.565-6.191,8.474,8.474,0,0,0-2.565-6.191,8.754,8.754,0,0,0-12.382,0,8.473,8.473,0,0,0-2.565,6.191A8.473,8.473,0,0,0,89.6,14.948,8.474,8.474,0,0,0,95.788,17.513Zm0,0"
                                            transform="translate(-80.852 0)" fill="#464646" />
                                        <path id="Path_137" data-name="Path 137"
                                            d="M30.258,257.711a21.629,21.629,0,0,0-.295-2.3,18.1,18.1,0,0,0-.565-2.31,11.407,11.407,0,0,0-.949-2.154,8.126,8.126,0,0,0-1.432-1.866,6.312,6.312,0,0,0-2.057-1.292,7.107,7.107,0,0,0-2.626-.475,2.665,2.665,0,0,0-1.423.6c-.427.278-.926.6-1.483.956a8.5,8.5,0,0,1-1.918.845,7.449,7.449,0,0,1-4.693,0,8.472,8.472,0,0,1-1.917-.845c-.552-.353-1.051-.674-1.484-.956a2.661,2.661,0,0,0-1.423-.6,7.1,7.1,0,0,0-2.625.476,6.308,6.308,0,0,0-2.057,1.292,8.129,8.129,0,0,0-1.431,1.866A11.431,11.431,0,0,0,.932,253.1a18.144,18.144,0,0,0-.565,2.309,21.553,21.553,0,0,0-.295,2.3c-.048.7-.073,1.418-.073,2.147a6.037,6.037,0,0,0,1.793,4.567,6.454,6.454,0,0,0,4.62,1.685H23.918a6.453,6.453,0,0,0,4.62-1.685,6.034,6.034,0,0,0,1.793-4.568c0-.733-.025-1.455-.074-2.147Zm0,0"
                                            transform="translate(0 -229.755)" fill="#464646" />
                                    </svg>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                    <div class="wrapper-page" *ngIf="isLoading" [ngStyle]="{'grid-template-columns': 'repeat(2, 1fr)'}">
                        <ng-container *ngFor="let item of dataLoading;let index = index">
                            <div class="page"
                                [ngStyle]="{'grid-column': index <= 24 ? '1' : '2', 'grid-row': index > 24 ? getGridRow(index) : ''}">
                                <div class="ranking">
                                    <img *ngIf="index === 0" src="../../../../assets/img/ranking-1.png" alt="">
                                    <img *ngIf="index === 1" src="../../../../assets/img/ranking-2.png" alt="">
                                    <img *ngIf="index === 2" src="../../../../assets/img/ranking-3.png" alt="">
                                    <span *ngIf="index > 2" class="ordering">{{index + 1}}</span>
                                    <span class="image div-preload"></span>
                                    <div class="div-preload" style="width: 50pt;"></div>
                                    <div class="div-preload" style="width: 70pt;"></div>
                                </div>
                                <div class="count">
                                    <div class="div-preload" style="width: 50pt; margin-right: 16px;"></div>
                                    <div class="div-preload" style="width: 30pt;"></div>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </ng-container>
    </div>
    <loading *ngIf="isLoading || isLoadingDate"></loading>
</div>